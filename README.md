# Little Net Helper ‚Äî Telegram-–±–æ—Ç –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –º–∏–Ω–∏-–ø—Ä–æ–≤–µ—Ä–æ–∫

**–ó–∞—á–µ–º:** –±—ã—Å—Ç—Ä—ã–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–µ—Ç–∏ –ø—Ä—è–º–æ –∏–∑ Telegram ‚Äî –±–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. *–û—Å–æ–±–µ–Ω–Ω–æ —É–¥–æ–±–Ω–æ –Ω–∞ iPhone!*
**–°—Ç–∞—Ç—É—Å:** –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è –∞–ª—å—Ñ–∞ + –ø—Ä–µ–≤—å—é –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ä–µ–ª–∏–∑–∞.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã (—Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–π –Ω–∞–±–æ—Ä):
- `üîÅ Ping (ICMP)` ‚Äî **–≥–æ—Ç–æ–≤–æ**
- `üîé DNS /ns` (nslookup) ‚Äî **–≤ –ø–ª–∞–Ω–∞—Ö —Ä–µ–ª–∏–∑–∞**
- `‚ùì WHOIS` ‚Äî **–≤ –ø–ª–∞–Ω–∞—Ö —Ä–µ–ª–∏–∑–∞**
- `üîê TLS info` ‚Äî **–≤ –ø–ª–∞–Ω–∞—Ö —Ä–µ–ª–∏–∑–∞**
- `üß≠ My IP` ‚Äî **–≤ –ø–ª–∞–Ω–∞—Ö —Ä–µ–ª–∏–∑–∞**

---

## –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è (–≥–ª–∞–∑–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
–ö–æ–º–∞–Ω–¥—ã: `/start` –∏–ª–∏ `/menu`.

–≠–∫—Ä–∞–Ω: ¬´–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ¬ª –∏ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏:
- `üîÅ Ping (ICMP)`
- `üîé DNS /ns`
- `ü™™ WHOIS`
- `üîê TLS info`
- `üß≠ My IP`

> –í —Ç–µ–∫—É—â–µ–π –∞–ª—å—Ñ–µ –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å –∫–Ω–æ–ø–æ–∫. –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –ø–æ—è–≤–∏—Ç—Å—è –ø–æ –º–µ—Ä–µ –≤–∫–ª—é—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π.

---

### Ping (ICMP) ‚Äî **–≥–æ—Ç–æ–≤–æ**
1. –ù–∞–∂–º–∏—Ç–µ **`üîÅ Ping (ICMP)`** ‚Äî –±–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç **–ø—É–±–ª–∏—á–Ω—ã–π IPv4 –∏–ª–∏ –¥–æ–º–µ–Ω**.  
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∞–¥—Ä–µ—Å (–ø—Ä–∏–º–µ—Ä: `8.8.8.8` –∏–ª–∏ `example.com`).  
3. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ 10 ICMP-–ø–∞–∫–µ—Ç–∞–º: –ø–µ—Ä–µ–¥–∞–Ω–æ/–ø–æ–ª—É—á–µ–Ω–æ/–ø–æ—Ç–µ—Ä–∏, `rtt min/avg/max/œÉ`, –∏ ¬´—Ö–≤–æ—Å—Ç¬ª –≤—ã–≤–æ–¥–∞ `ping`.  
4. –ü–æ–¥ –æ—Ç–≤–µ—Ç–æ–º ‚Äî –∫–Ω–æ–ø–∫–∏:
   - **`üîÅ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å`** (–ø–∏–Ω–≥ —Ç–æ–π –∂–µ —Ü–µ–ª–∏)
   - **`üè† –ú–µ–Ω—é`** (–≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é)

**–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ø–æ–Ω—è—Ç–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–∞–∑–∞ (—á–∞—Å—Ç–Ω—ã–µ —Å–µ—Ç–∏, loopback, –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç) + ¬´**üîÅ –í–≤–µ—Å—Ç–∏ –∑–∞–Ω–æ–≤–æ**¬ª.

---

### DNS /ns (nslookup) ‚Äî **–≤ –ø–ª–∞–Ω–∞—Ö —Ä–µ–ª–∏–∑–∞**
- –ü–æ—Ç–æ–∫: –≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø –∑–∞–ø–∏—Å–∏ ‚Üí –≤–≤–µ—Å—Ç–∏ –¥–æ–º–µ–Ω ‚Üí –æ—Ç–≤–µ—Ç —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–ø–∏—Å–µ–π (A/AAAA/CNAME/MX/TXT/NS/PTR) –∏ TTL.  
- –ö–Ω–æ–ø–∫–∏: **¬´–ü–æ–≤—Ç–æ—Ä–∏—Ç—å¬ª**, **¬´–°–º–µ–Ω–∏—Ç—å —Ç–∏–ø¬ª**, **¬´–ú–µ–Ω—é¬ª**.  
- –î–ª–∏–Ω–Ω—ã–µ TXT ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∞–π–ª `.txt`.

### WHOIS ‚Äî **–≤ –ø–ª–∞–Ω–∞—Ö —Ä–µ–ª–∏–∑–∞**
- –í–≤–æ–¥: –¥–æ–º–µ–Ω –∏–ª–∏ IP/–ø–æ–¥—Å–µ—Ç—å.  
- –û—Ç–≤–µ—Ç: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä/ORG, –¥–∞—Ç—ã `created/expiry`, –¥–ª—è IP ‚Äî ASN/–¥–∏–∞–ø–∞–∑–æ–Ω.  
- –î–ª–∏–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç ‚Äî —Ñ–∞–π–ª–æ–º `.txt`.

### TLS info ‚Äî **–≤ –ø–ª–∞–Ω–∞—Ö —Ä–µ–ª–∏–∑–∞**
- –í–≤–æ–¥: `host[:port]` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 443).  
- –û—Ç–≤–µ—Ç: `CN/SAN`, –∏–∑–¥–∞—Ç–µ–ª—å, `notBefore/notAfter`, –¥–Ω–µ–π –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è.

### My IP ‚Äî **–≤ –ø–ª–∞–Ω–∞—Ö —Ä–µ–ª–∏–∑–∞**
- –ë–µ–∑ –≤–≤–æ–¥–∞.  
- –û—Ç–≤–µ—Ç: –≤–Ω–µ—à–Ω–∏–π IP —Å–µ—Ä–≤–µ—Ä–∞/–±–æ—Ç–∞.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–æ–±–∑–æ—Ä)

### –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏
Telegram (getUpdates)
‚îÇ
‚ñº
long_polling.py -> dispatcher.py -> handlers/* -> telegram_client.py
‚ñ≤
‚îÇ
net_tools/*
‚îÇ
‚ñº
db_client.py (SQLite)


### –ü–∞—Ç—Ç–µ—Ä–Ω—ã
- **Dispatcher / Chain of Responsibility.**  
  –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ö—ç–Ω–¥–ª–µ—Ä–æ–≤. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ø–¥–µ–π—Ç–∞:
  - `canHandle(update) -> bool` ‚Äî ¬´–º–æ–µ –ª–∏ —Å–æ–±—ã—Ç–∏–µ?¬ª  
  - `handle(update, state, data) -> HandlerStatus` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —à–∞–≥–∞.  
  `STOP` –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ü–µ–ø–æ—á–∫—É, `CONTINUE` –ø–µ—Ä–µ–¥–∞—ë—Ç —Å–ª–µ–¥—É—é—â–µ–º—É —Ö—ç–Ω–¥–ª–µ—Ä—É.

- **Finite State (–ø–µ—Ä-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ).**  
  `users.state` —Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–∏–π ¬´—Ä–µ–∂–∏–º¬ª —Å—Ü–µ–Ω–∞—Ä–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `PING_WAIT_TARGET`). –õ—é–±–æ–π —Ç–µ–∫—Å—Ç –≤ —ç—Ç–æ–º —Ä–µ–∂–∏–º–µ —Ç—Ä–∞–∫—Ç—É–µ—Ç—Å—è –∫–∞–∫ –≤–≤–æ–¥ –∞–¥—Ä–µ—Å–∞.

- **–ß–∏—Å—Ç—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ (`net_tools/*`).**  
  –ù–∏–∫–∞–∫–æ–π –∑–∞–≤—è–∑–∫–∏ –Ω–∞ Telegram; —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –≤ —Ö—ç–Ω–¥–ª–µ—Ä–µ.

- **–¢–æ–Ω–∫–∞—è –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Telegram Bot API.**  
  `telegram_client.py`: `getUpdates`, `sendMessage`, `editMessageText`, `answerCallbackQuery` (+ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ `sendDocument`).

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **SQLite** (stdlib `sqlite3`) –¥–ª—è MVP.
- –°—Ö–µ–º–∞ (–º–∏–Ω–∏–º—É–º):
  ```sql
  CREATE TABLE IF NOT EXISTS users (
    telegram_id INTEGER PRIMARY KEY,
    state       TEXT NOT NULL DEFAULT '',
    data        TEXT NOT NULL DEFAULT '{}'  -- JSON (–Ω–∞–ø—Ä., last_ping_target)
  );

  CREATE TABLE IF NOT EXISTS telegram_updates (
    id      INTEGER PRIMARY KEY AUTOINCREMENT,
    payload TEXT NOT NULL                   -- JSON –∞–ø–¥–µ–π—Ç–∞
  );

  PRAGMA journal_mode=WAL;
  CREATE INDEX IF NOT EXISTS idx_users_state ON users(state);

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
### Ping (ICMP)

- –ö–∞–∫: —Å–∏—Å—Ç–µ–º–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ ping (-c 10 -n -W 2), –ø–∞—Ä—Å–∏–Ω–≥ —Å–≤–æ–¥–∫–∏ transmitted/received/loss –∏ rtt min/avg/max/‚Ä¶.
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –∑–∞–ø—Ä–µ—â–µ–Ω—ã —á–∞—Å—Ç–Ω—ã–µ/`loopback`/`link-local`/—Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã.
- –í—ã–≤–æ–¥: –∫—Ä–∞—Ç–∫–∏–π summary + ¬´—Ö–≤–æ—Å—Ç¬ª –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ `ping` –≤ –±–ª–æ–∫–µ –∫–æ–¥–∞; –∫–Ω–æ–ø–∫–∏ ¬´`–ü–æ–≤—Ç–æ—Ä–∏—Ç—å`/`–ú–µ–Ω—é`¬ª.

### DNS /ns (nslookup)

- –ö–∞–∫: dnspython (—á–∏—Å—Ç—ã–π Python), —Ç–∏–ø—ã: `A`/`AAAA`/`CNAME`/`MX`/`TXT`/`NS`/`PTR`, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤/—Ä–µ–∑–æ–ª–≤–µ—Ä–æ–≤.
- –§–æ—Ä–º–∞—Ç: –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π (–¥–ª—è `MX` ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç/—Ö–æ—Å—Ç; –¥–ª—è `TXT` ‚Äî —Ç—Ä–∏–º–º–∏–Ω–≥ –∏–ª–∏ —Ñ–∞–π–ª).

### WHOIS

- –ö–∞–∫: `python-whois` (–¥–æ–º–µ–Ω—ã) –∏ `ipwhois` (IP/ASN —á–µ—Ä–µ–∑ RDAP).
- –§–æ—Ä–º–∞—Ç: `registrar`/`ORG`, `created`/`updated`/`expiry`, `ASN`/`route`. –î–ª–∏–Ω–Ω—ã–π –≤—ã–≤–æ–¥ ‚Äî `.txt`.

### TLS info

- –ö–∞–∫: ssl + TCP-—Å–æ–∫–µ—Ç: –∏–∑–≤–ª–µ–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, –ø–∞—Ä—Å–∏–º –ø–æ–ª—è CN, SAN, issuer, —Å—Ä–æ–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è; —Å—á–∏—Ç–∞–µ–º ¬´–¥–Ω–µ–π –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è¬ª.
- –§–æ—Ä–º–∞—Ç: –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫, –±–µ–∑ ¬´—Å—ã—Ä–æ–π¬ª DER; –ø—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî —á–∏—Ç–∞–µ–º–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (SNI/handshake/hostname mismatch).

### My IP

- –ö–∞–∫ : —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π —Ä–µ–∑–æ–ª–≤–µ—Ä OpenDNS: –∑–∞–ø—Ä–æ—Å `myip.opendns.com` —É `resolver1.opendns.com` (–≤ `dnspython`),
- –§–æ—Ä–º–∞—Ç: –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Å IPv4.

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–º–∏–Ω–∏–º—É–º –¥–ª—è —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞)

- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:
  - `python-dotenv` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ `.env`;
  - `dnspython` ‚Äî DNS (`/ns`);
  - `python-whois` ‚Äî WHOIS (–¥–æ–º–µ–Ω—ã);
  - `ipwhois` ‚Äî WHOIS (IP/ASN).


–ü—Ä–∏–º–µ—Ä `requirements.txt`:
```
python-dotenv>=1.0
dnspython>=2.6
python-whois>=0.8
ipwhois>=1.2
```
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

- –û–∫—Ä—É–∂–µ–Ω–∏–µ:
```
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .env:
```
TELEGRAM_BASE_URI=https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>
SQLITE_DB_PATH=/–∞–±—Å–æ–ª—é—Ç–Ω—ã–π/–ø—É—Ç—å/–∫/bot.db
```

- –°–æ–∑–¥–∞—Ç—å/–ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î:
```
python -m bot.recreate_database
```

- –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ (polling):
```
python -m bot
```
## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ª–∏–º–∏—Ç—ã

- –í–≤–æ–¥ –∞–¥—Ä–µ—Å–æ–≤/–¥–æ–º–µ–Ω–æ–≤ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è; –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ/–ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è.
- –¢–∞–π–º–∞—É—Ç—ã –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –≤—ã–≤–æ–¥–∞.
- –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ systemd/Docker-—Ä–µ—Å—Ç–∞—Ä—Ç; polling-–ø—Ä–æ—Ü–µ—Å—Å –¥–æ–ª–∂–µ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å.